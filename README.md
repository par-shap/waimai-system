# 外卖点餐系统

一个基于前端技术的外卖点餐系统，包含前台点餐和后台管理功能，使用IndexedDB实现数据持久化和前后台数据同步。

## 项目结构

```
外卖点餐系统/
├── order.html          # 前台点餐页面
├── order.js            # 前台点餐逻辑
├── address.html        # 地址管理页面
├── address.js          # 地址管理逻辑
├── payment.html        # 支付页面
├── payment.js          # 支付逻辑
├── database.js         # IndexedDB数据库管理模块
├── test-db.html        # 数据库测试页面
├── admin/
│   ├── index.html      # 后台管理页面
│   └── admin.js        # 后台管理逻辑
└── README.md           # 项目说明文档
```

## 核心功能

### 前台功能
- **商家浏览**: 显示所有活跃商家，支持搜索
- **菜品选择**: 查看商家菜品，添加到购物车
- **购物车管理**: 添加、删除、修改商品数量
- **地址管理**: 保存和管理配送地址
- **订单结算**: 生成订单并跳转支付

### 后台功能
- **商家管理**: 添加、编辑、删除商家信息
- **菜品管理**: 为商家添加、编辑、删除菜品
- **数据同步**: 实时同步前台显示的数据

## 后台订单管理系统（orderAdminManageSystem）

### 功能简介
后台订单管理系统是外卖点餐系统的重要组成部分，主要用于对用户订单进行统一管理和操作。管理员可通过该系统实时查看、处理和管理所有订单，确保订单流转高效、数据准确。

### 主要功能
- **订单列表**：展示所有用户订单，支持按时间、状态等条件筛选。
- **订单详情**：查看每一笔订单的详细信息，包括下单用户、收货地址、菜品明细、总金额、下单时间等。
- **订单状态管理**：支持修改订单状态（如：待处理、配送中、已完成、已取消等），并同步到前台用户端。
- **订单搜索**：可根据订单号、用户信息、商家名称等关键词快速检索订单。
- **数据同步**：所有订单数据与前台实时同步，保证信息一致性。

### 使用方法
1. 管理员登录后台管理系统（`admin/index.html`）。
2. 进入"订单管理"模块，浏览和筛选所有订单。
3. 点击订单可查看详情，并可根据实际情况修改订单状态。
4. 所有操作均会实时保存至本地IndexedDB数据库，前台用户刷新后可看到最新订单状态。

### 技术实现
- 订单数据存储于IndexedDB数据库的`orders`表中。
- 前后台共用同一数据库，实现数据实时同步。
- 订单管理界面采用模块化设计，操作便捷，界面美观。
- 支持多条件筛选和模糊搜索，提升管理效率。

### 注意事项
- 仅管理员账号可访问订单管理系统。
- 修改订单状态后请及时通知相关人员（如骑手、用户）。
- 删除订单操作需谨慎，避免误删。

## 数据库结构

### IndexedDB 表结构

#### 商家表 (restaurants)
```javascript
{
  id: String,           // 商家ID
  name: String,         // 商家名称
  image: String,        // 商家图片URL
  rating: Number,       // 评分
  sales: Number,        // 月售量
  minOrder: Number,     // 起送价
  deliveryFee: Number,  // 配送费
  deliveryTime: String, // 配送时间
  status: String        // 状态 (active/inactive)
}
```

#### 菜品表 (menuItems)
```javascript
{
  id: String,           // 菜品ID
  restaurantId: String, // 所属商家ID
  name: String,         // 菜品名称
  price: Number,        // 价格
  image: String,        // 菜品图片URL
  description: String   // 菜品描述
}
```

#### 订单表 (orders)
```javascript
{
  id: String,           // 订单ID
  restaurantId: String, // 商家ID
  restaurantName: String, // 商家名称
  items: Array,         // 订单商品
  total: Number,        // 总金额
  status: String,       // 订单状态
  createTime: String    // 创建时间
}
```

#### 用户地址表 (userAddresses)
```javascript
{
  id: String,           // 地址ID
  name: String,         // 收货人姓名
  phone: String,        // 联系电话
  address: String,      // 详细地址
  isDefault: Boolean    // 是否默认地址
}
```

## 数据同步机制

### 核心原理
- **共享数据库**: 前台和后台使用同一个IndexedDB数据库
- **实时同步**: 后台修改数据后，前台刷新即可看到最新数据
- **数据持久化**: 数据存储在浏览器本地，刷新页面不会丢失

### 同步流程
1. **初始化**: 系统启动时自动初始化数据库和默认数据
2. **数据读取**: 前台从数据库读取活跃商家数据
3. **数据修改**: 后台可以添加、编辑、删除商家和菜品
4. **实时更新**: 前台刷新页面时重新从数据库读取最新数据

### 默认数据
系统初始化时会自动创建以下默认数据：
- **5个商家**: 肯德基、麦当劳、汉堡王、德克士、必胜客
- **25个菜品**: 每个商家5个菜品
- **状态管理**: 所有商家默认为活跃状态

## 使用说明

### 前台使用
1. 打开 `order.html` 查看商家列表
2. 点击商家查看菜品详情
3. 添加菜品到购物车
4. 完成订单并填写地址信息
5. 进入支付页面

### 后台管理
1. 打开 `admin/index.html`
2. 使用默认账号登录 (用户名: admin, 密码: 123456)
3. 管理商家信息 (添加、编辑、删除)
4. 管理菜品信息 (为商家添加、编辑、删除菜品)
5. 删除商家时会自动删除该商家的所有菜品

### 数据测试
1. 打开 `test-db.html` 查看数据库状态
2. 可以清空数据库、重新初始化默认数据
3. 查看商家和菜品的详细信息

## 技术特点

### 数据同步优势
- **无服务器依赖**: 纯前端实现，无需后端服务
- **实时同步**: 前后台数据实时同步，无需手动刷新
- **数据持久化**: 使用IndexedDB确保数据不丢失
- **状态管理**: 支持商家状态管理，可暂停营业

### 用户体验
- **响应式设计**: 适配不同屏幕尺寸
- **现代化UI**: 使用Tailwind CSS构建美观界面
- **流畅交互**: 平滑的动画和过渡效果
- **搜索功能**: 支持商家名称搜索

### 开发友好
- **模块化设计**: 数据库操作封装在独立模块中
- **错误处理**: 完善的错误处理和用户提示
- **代码注释**: 详细的代码注释和文档说明
- **测试工具**: 提供数据库测试页面

## 注意事项

1. **浏览器兼容性**: 需要支持IndexedDB的现代浏览器
2. **数据存储**: 数据存储在浏览器本地，清除浏览器数据会丢失
3. **商家状态**: 只有状态为"active"的商家才会在前台显示
4. **数据一致性**: 删除商家时会自动删除相关菜品，保持数据一致性

## 故障排除

### 数据不同步问题
1. 确保前台和后台都引用了 `database.js`
2. 检查浏览器控制台是否有错误信息
3. 使用 `test-db.html` 检查数据库状态
4. 尝试清空数据库并重新初始化

### 页面显示问题
1. 检查网络连接，确保能加载Tailwind CSS
2. 确保所有JavaScript文件正确引用
3. 检查浏览器控制台的错误信息

### 功能异常
1. 确保使用支持IndexedDB的浏览器
2. 检查浏览器是否启用了本地存储
3. 尝试清除浏览器缓存后重新访问 